<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Guide du Détour</title>
  <meta name="description" content="Transformez chaque trajet en voyage. Choisissez un détour de 0 à 20 km : Guide du Détour vous montre ce qui vaut le détour sur votre route." />
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#FAFAFA] text-gray-800 antialiased">

  <!-- HERO -->
  <section class="min-h-screen flex items-center px-6">
    <div class="max-w-6xl mx-auto w-full grid lg:grid-cols-2 gap-12 items-center">
      <!-- Text -->
      <div class="text-center lg:text-left">
        <h1 class="text-4xl md:text-6xl font-semibold leading-tight">
          Transformez chaque trajet
          <span class="text-gray-900 block mt-2">en voyage.</span>
        </h1>

        <p class="mt-6 text-lg md:text-xl text-gray-600 max-w-2xl mx-auto lg:mx-0">
          Guide du Détour révèle ce qui vaut le détour sur votre route —
          si vous êtes prêt à vous écarter de <span class="text-gray-900 font-semibold">0 à 20 km</span>.
        </p>

        <p class="mt-3 text-sm text-gray-500">
          Vous choisissez la distance. Nous trouvons les lieux.
        </p>

        <!-- Detour range -->
        <div class="mt-7">
          <div class="flex items-center justify-center lg:justify-start gap-3">
            <span class="text-sm text-gray-500">0 km</span>

            <div class="w-full max-w-md">
              <input id="detourRange" type="range" min="0" max="20" step="1" value="5"
                class="w-full accent-gray-900" />
              <div class="mt-2 flex items-center justify-between">
                <div class="text-sm text-gray-600">
                  Détour max :
                  <span id="detourValue" class="text-gray-900 font-semibold">5</span>
                  <span class="text-gray-600">km</span>
                </div>
                <div class="text-xs text-gray-500">
                  (modifiable à tout moment)
                </div>
              </div>
            </div>

            <span class="text-sm text-gray-500">20 km</span>
          </div>

          <div class="mt-3 text-sm text-gray-500 text-center lg:text-left">
            Exemple :
            <span class="text-gray-700">« Je suis prêt à faire un détour de </span>
            <span id="detourInline" class="font-semibold text-gray-700">5</span>
            <span class="text-gray-700"> km. »</span>
          </div>
        </div>

        <div class="mt-10 flex flex-col sm:flex-row gap-3 justify-center lg:justify-start">
          <a href="#waitlist"
             class="inline-flex items-center justify-center px-8 py-4 bg-gray-900 text-white rounded-full text-lg hover:bg-gray-700 transition">
            Être informé du lancement
          </a>
          <a href="#how"
             class="inline-flex items-center justify-center px-8 py-4 bg-white text-gray-900 rounded-full text-lg ring-1 ring-gray-200 hover:ring-gray-300 transition">
            Voir comment ça marche
          </a>
        </div>

        <p class="mt-6 text-sm text-gray-500">
          Pas de spam. Juste le lancement et les mises à jour importantes.
        </p>
      </div>

      <!-- Phone mockup + slider -->
      <div class="flex justify-center lg:justify-end">
        <div class="relative">
          <div class="absolute -inset-6 rounded-[48px] bg-white/60 blur-2xl"></div>

          <div class="relative w-[280px] sm:w-[320px] md:w-[360px] aspect-[9/19] rounded-[44px] bg-gray-900 p-[10px] shadow-2xl">
            <div class="relative w-full h-full rounded-[36px] bg-black overflow-hidden">
              <div class="absolute top-3 left-1/2 -translate-x-1/2 w-32 h-6 rounded-full bg-black/80 ring-1 ring-white/10 z-20"></div>

              <img
                id="appSlider"
                src="./screen1.png"
                alt="Aperçu de l’application"
                class="w-full h-full object-cover opacity-100 transition-opacity duration-700"
              />

              <div id="sliderFallback" class="hidden w-full h-full items-center justify-center p-8 text-center">
                <div class="text-white/80">
                  <div class="text-xl font-semibold">Ajoutez vos captures</div>
                  <div class="mt-2 text-sm text-white/60">
                    Placez <span class="font-mono">screen1.png</span> … <span class="font-mono">screen5.png</span><br/>
                    à côté de <span class="font-mono">index.html</span>
                  </div>
                </div>
              </div>

              <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/25 via-transparent to-white/5 z-10"></div>

              <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-20">
                <span class="dot w-2 h-2 rounded-full bg-white/40"></span>
                <span class="dot w-2 h-2 rounded-full bg-white/40"></span>
                <span class="dot w-2 h-2 rounded-full bg-white/40"></span>
                <span class="dot w-2 h-2 rounded-full bg-white/40"></span>
                <span class="dot w-2 h-2 rounded-full bg-white/40"></span>
              </div>
            </div>
          </div>

          <!-- captions under phone (story, not “just images”) -->
          <div class="mt-4 text-center text-sm text-gray-500">
            <span id="slideCaption">Votre itinéraire</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- PROBLEME -->
  <section class="py-24 px-6 max-w-5xl mx-auto">
    <h2 class="text-3xl md:text-4xl font-semibold mb-6">
      Les GPS vont vite.<br>Mais ils passent à côté de l’essentiel.
    </h2>

    <p class="text-lg text-gray-600 max-w-3xl">
      Villages, églises, points de vue, patrimoine, fermes, lieux insolites…
      Souvent, c’est à <span class="text-gray-800 font-medium">quelques kilomètres</span> de la route.
      <br><br>
      Vous arrivez à destination — mais vous n’avez rien vu.
    </p>
  </section>

  <!-- POURQUOI (diff vs Google Maps) -->
  <section class="py-24 px-6 bg-white">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-3xl md:text-4xl font-semibold mb-6">
        Pourquoi Guide du Détour ?
      </h2>

      <p class="text-lg text-gray-600 max-w-3xl">
        Google Maps vous emmène vite. Guide du Détour vous aide à
        <span class="text-gray-800 font-medium">découvrir</span> — sans perdre le contrôle.
      </p>

      <div class="mt-10 grid sm:grid-cols-3 gap-4">
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">La liberté en kilomètres</div>
          <div class="mt-1 text-sm text-gray-600">Définissez votre marge (0–20 km). Ni plus, ni moins.</div>
        </div>
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Des lieux qui comptent</div>
          <div class="mt-1 text-sm text-gray-600">Patrimoine, paysages, villages… ce que les itinéraires rapides ignorent.</div>
        </div>
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Une carte qui s’améliore</div>
          <div class="mt-1 text-sm text-gray-600">Photo, description, correction : la communauté enrichit la route.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- COMMENT -->
  <section id="how" class="py-24 px-6 max-w-5xl mx-auto">
    <h2 class="text-3xl md:text-4xl font-semibold mb-10">
      Comment ça marche
    </h2>

    <div class="grid md:grid-cols-3 gap-10 text-lg text-gray-600">
      <div class="bg-white rounded-3xl p-8 ring-1 ring-gray-100">
        <strong class="text-gray-900">1. Entrez votre itinéraire</strong><br>
        De A à B, comme d’habitude.
      </div>
      <div class="bg-white rounded-3xl p-8 ring-1 ring-gray-100">
        <strong class="text-gray-900">2. Choisissez votre détour</strong><br>
        De 0 à 20 km. Vous gardez le contrôle.
      </div>
      <div class="bg-white rounded-3xl p-8 ring-1 ring-gray-100">
        <strong class="text-gray-900">3. Découvrez & partagez</strong><br>
        Explorez, apprenez, ajoutez votre touche.
      </div>
    </div>
  </section>

  <!-- POUR QUI -->
  <section class="py-24 px-6 bg-white">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-3xl md:text-4xl font-semibold mb-6">
        Pour qui ?
      </h2>

      <p class="text-lg text-gray-600 max-w-3xl">
        Pour ceux qui aiment ce qu’il y a <span class="text-gray-800 font-medium">entre</span> le départ et l’arrivée.
      </p>

      <div class="mt-10 grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Familles</div>
          <div class="mt-1 text-sm text-gray-600">Des pauses “waouh” au lieu d’une aire d’autoroute.</div>
        </div>
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Couples</div>
          <div class="mt-1 text-sm text-gray-600">Un trajet devient une escapade.</div>
        </div>
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Amis</div>
          <div class="mt-1 text-sm text-gray-600">Découvertes, souvenirs, défis (bientôt).</div>
        </div>
        <div class="rounded-3xl bg-[#FAFAFA] ring-1 ring-gray-100 p-6">
          <div class="text-gray-900 font-semibold">Voyageurs curieux</div>
          <div class="mt-1 text-sm text-gray-600">Patrimoine, villages, points de vue.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- WAITLIST (Firebase) -->
  <section id="waitlist" class="py-24 px-6 max-w-5xl mx-auto">
    <div class="bg-white rounded-3xl ring-1 ring-gray-100 p-8 md:p-10">
      <h2 class="text-3xl md:text-4xl font-semibold">
        Recevez une invitation
      </h2>
      <p class="mt-4 text-lg text-gray-600 max-w-3xl">
        Laissez votre email : on vous envoie l’accès dès l’ouverture.
        <span class="text-gray-800 font-medium">Pas de spam.</span>
      </p>

      <form id="waitlistForm" class="mt-8 grid sm:grid-cols-[1fr_auto] gap-3 items-start">
        <div>
          <label class="sr-only" for="email">Email</label>
          <input id="email" name="email" type="email" inputmode="email" autocomplete="email" required
                 placeholder="Votre email"
                 class="w-full px-5 py-4 rounded-2xl bg-[#FAFAFA] ring-1 ring-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-900/30" />
          <div class="mt-3 flex items-start gap-2">
            <input id="privacy" type="checkbox" required class="mt-1 h-4 w-4 rounded border-gray-300" />
            <label for="privacy" class="text-sm text-gray-600">
              J’accepte la <a class="underline hover:text-gray-900" href="#privacyPolicy">politique de confidentialité</a>.
            </label>
          </div>

          <div class="mt-3 text-sm text-gray-600">
            Détour max choisi : <span id="detourValue2" class="font-semibold text-gray-900">5</span> km
          </div>
        </div>

        <button id="submitBtn" type="submit"
                class="px-7 py-4 rounded-2xl bg-gray-900 text-white text-lg hover:bg-gray-700 transition disabled:opacity-60 disabled:cursor-not-allowed">
          Rejoindre la liste d’attente
        </button>
      </form>

      <div id="formMsg" class="mt-4 text-sm"></div>

      <div class="mt-8 grid sm:grid-cols-3 gap-3 text-sm text-gray-600">
        <div class="rounded-2xl bg-[#FAFAFA] ring-1 ring-gray-100 p-4">
          <div class="text-gray-900 font-semibold">Plateforme</div>
          <div class="mt-1">iOS d’abord (bêta), Android ensuite.</div>
        </div>
        <div class="rounded-2xl bg-[#FAFAFA] ring-1 ring-gray-100 p-4">
          <div class="text-gray-900 font-semibold">Zone</div>
          <div class="mt-1">France (d’abord), puis extension.</div>
        </div>
        <div class="rounded-2xl bg-[#FAFAFA] ring-1 ring-gray-100 p-4">
          <div class="text-gray-900 font-semibold">Promesse</div>
          <div class="mt-1">Un seul email : le lancement. Rien de plus.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- FINAL PUSH -->
  <section class="py-20 px-6 text-center bg-white">
    <h2 class="text-3xl md:text-4xl font-semibold mb-4">
      Prêt à redécouvrir la France… par la route ?
    </h2>
    <p class="text-gray-600 max-w-3xl mx-auto">
      La destination est importante. Le chemin l’est souvent encore plus.
    </p>
    <a href="#waitlist"
       class="inline-block mt-7 px-10 py-4 bg-gray-900 text-white rounded-full text-lg hover:bg-gray-700 transition">
      Être informé du lancement
    </a>
  </section>

  <!-- PRIVACY POLICY -->
  <section id="privacyPolicy" class="py-16 px-6 max-w-5xl mx-auto">
    <div class="text-sm text-gray-600">
      <h3 class="text-gray-900 font-semibold text-xl">Politique de confidentialité (résumé)</h3>
      <p class="mt-3">
        Nous collectons uniquement votre email pour vous envoyer une invitation et des informations liées au lancement.
        Vous pouvez demander la suppression de votre email à tout moment.
      </p>
      <p class="mt-3">
        (Remplacez ce texte par votre version officielle dès que possible.)
      </p>
    </div>
  </section>

  <!-- ========== SCRIPTS ========== -->

  <!-- Slider script (robust) + captions -->
  <script>
    (function () {
      const screens = [
        "./screen1.png",
        "./screen2.png",
        "./screen3.png",
        "./screen4.png",
        "./screen5.png"
      ];

      const captions = [
        "Votre itinéraire",
        "Votre détour en kilomètres",
        "Ce qui vaut l’arrêt",
        "Une fiche claire : infos, histoire, photos",
        "Contribuez : ajoutez, corrigez, partagez"
      ];

      const img = document.getElementById("appSlider");
      const fallback = document.getElementById("sliderFallback");
      const dots = Array.from(document.querySelectorAll(".dot"));
      const captionEl = document.getElementById("slideCaption");

      if (!img) return;

      let index = 0;
      const intervalMs = 2200;
      const fadeOutMs = 350;

      function setActiveDot(i) {
        dots.forEach((d, idx) => {
          d.classList.toggle("bg-white/90", idx === i);
          d.classList.toggle("bg-white/40", idx !== i);
        });
      }

      function setCaption(i) {
        if (!captionEl) return;
        captionEl.textContent = captions[i] || "Aperçu de l’application";
      }

      function canLoad(src) {
        return new Promise((resolve) => {
          const test = new Image();
          test.onload = () => resolve(true);
          test.onerror = () => resolve(false);
          test.src = src + (src.includes("?") ? "&" : "?") + "v=" + Date.now();
        });
      }

      async function findNextValid(startIdx) {
        for (let step = 0; step < screens.length; step++) {
          const i = (startIdx + step) % screens.length;
          if (await canLoad(screens[i])) return i;
        }
        return -1;
      }

      async function init() {
        const firstValid = await findNextValid(0);
        if (firstValid === -1) {
          img.classList.add("hidden");
          fallback.classList.remove("hidden");
          return;
        }
        index = firstValid;
        img.src = screens[index];
        setActiveDot(index);
        setCaption(index);
      }

      async function tick() {
        img.classList.add("opacity-0");
        setTimeout(async () => {
          const nextIdx = await findNextValid(index + 1);
          if (nextIdx === -1) {
            img.classList.add("hidden");
            fallback.classList.remove("hidden");
            return;
          }
          index = nextIdx;
          img.src = screens[index];
          setActiveDot(index);
          setCaption(index);
          img.classList.remove("opacity-0");
        }, fadeOutMs);
      }

      init().then(() => setInterval(tick, intervalMs));
    })();
  </script>

  <!-- Detour range logic -->
  <script>
    (function () {
      const range = document.getElementById("detourRange");
      const v1 = document.getElementById("detourValue");
      const v2 = document.getElementById("detourValue2");
      const inline = document.getElementById("detourInline");

      let current = Number(range?.value ?? 5);

      function set(km) {
        current = Number(km);
        if (v1) v1.textContent = String(current);
        if (v2) v2.textContent = String(current);
        if (inline) inline.textContent = String(current);
      }

      if (range) {
        range.addEventListener("input", (e) => set(e.target.value));
        set(range.value);
      }

      window.__detourKm = () => current;
    })();
  </script>

  <!-- Firebase Firestore submit (CDN ESM) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

    // ✅ Your Firebase config (public, ok to be in code)
    const firebaseConfig = {
      apiKey: "AIzaSyCWQJtzHMksDG5UgLVma8LnYiOxYYcv_AQ",
      authDomain: "guide-du-detour.firebaseapp.com",
      projectId: "guide-du-detour",
      storageBucket: "guide-du-detour.firebasestorage.app",
      messagingSenderId: "182479723840",
      appId: "1:182479723840:web:866963483cf1bca6f9aea5",
      measurementId: "G-17851JKM7F"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const form = document.getElementById("waitlistForm");
    const emailInput = document.getElementById("email");
    const privacy = document.getElementById("privacy");
    const msg = document.getElementById("formMsg");
    const btn = document.getElementById("submitBtn");

    function setMsg(text, type = "info") {
      msg.className = "mt-4 text-sm";
      if (type === "ok") msg.classList.add("text-green-700");
      if (type === "err") msg.classList.add("text-red-700");
      if (type === "info") msg.classList.add("text-gray-600");
      msg.textContent = text;
    }

    function isEmailValid(v) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(v).trim());
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      setMsg("");

      const email = String(emailInput.value || "").trim();
      if (!isEmailValid(email)) {
        setMsg("Veuillez entrer un email valide.", "err");
        emailInput.focus();
        return;
      }
      if (!privacy.checked) {
        setMsg("Veuillez accepter la politique de confidentialité.", "err");
        privacy.focus();
        return;
      }

      btn.disabled = true;
      btn.textContent = "Envoi…";

      try {
        await addDoc(collection(db, "waitlist"), {
          email,
          detourKm: (window.__detourKm && window.__detourKm()) ? window.__detourKm() : 0,
          source: "landing_page_french",
          createdAt: serverTimestamp(),
          userAgent: navigator.userAgent || null,
          language: navigator.language || null,
          timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || null
        });

        setMsg("Merci ! Vous êtes sur la liste. On vous contacte au lancement.", "ok");
        form.reset();
      } catch (err) {
        console.error(err);
        setMsg("Oups. Impossible d’envoyer pour le moment. Réessayez dans quelques minutes.", "err");
      } finally {
        btn.disabled = false;
        btn.textContent = "Rejoindre la liste d’attente";
      }
    });
  </script>

</body>
</html>
